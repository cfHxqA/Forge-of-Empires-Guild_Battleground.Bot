// ==UserScript==
// @name        BotNix - FoE-Helper.Bot
// @namespace   BotNix.FoE_Helper
// @version     4.0.0.0
//
// @author      cfHxqA
// @copyright   2013 - 2025 (C) cfHxqA
//
// @downloadURL https://raw.githubusercontent.com/cfHxqA/Forge-of-Empires-Helper.Bot/refs/heads/main/tampermonkey.user.js
// @updateURL   https://raw.githubusercontent.com/cfHxqA/Forge-of-Empires-Helper.Bot/refs/heads/main/tampermonkey.user.js
//
// @require     https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js
// @require     https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.30.1/moment.min.js
//
// @match       *://*.forgeofempires.com/game/index*
// @match       *://*.forgeofempires.com/socket/
//
// @grant       GM.deleteValue
// @grant       GM.getValue
// @grant       GM.setValue
// @grant       GM.cookie
// @grant       GM.xmlHttpRequest
// @grant       unsafeWindow
//
// @run-at      document-start
// ==/UserScript==
const _0xc2854d=_0x36f4;(function(_0x602d4e,_0x49e500){const _0x118f5c=_0x36f4,_0x27f2db=_0x602d4e();while(!![]){try{const _0x4e646e=parseInt(_0x118f5c(0xf4))/0x1*(-parseInt(_0x118f5c(0xf3))/0x2)+-parseInt(_0x118f5c(0xfc))/0x3+-parseInt(_0x118f5c(0xdf))/0x4*(parseInt(_0x118f5c(0xe1))/0x5)+-parseInt(_0x118f5c(0xcd))/0x6+parseInt(_0x118f5c(0xd2))/0x7+parseInt(_0x118f5c(0xd6))/0x8+-parseInt(_0x118f5c(0xde))/0x9*(-parseInt(_0x118f5c(0xf8))/0xa);if(_0x4e646e===_0x49e500)break;else _0x27f2db['push'](_0x27f2db['shift']());}catch(_0x462e01){_0x27f2db['push'](_0x27f2db['shift']());}}}(_0x4734,0xa9e3a));function _0x4734(){const _0x1bafda=['2044145OurTEz','setValue','ForgeHX-','ERROR\x20|\x20Necessary\x20changes\x20were\x20not\x20applied!','cRetry','text/javascript','YYYY-MM-DD\x20HH:mm:ss','$1\x27ws://127.0.0.1/socket/\x27,','BotNix_FoE_Helper','innerHTML','$1(\x22Client-Identification-SID\x22,\x20\x22','url','getValue','value','slice','assign','log','toLowerCase','4PFXIMc','135894dLVRiI','replace','list','append','1060RUgCKG','script','No\x20jQuery!\x20Aborting!','toString','2980443rqdCIb','object','cookie','ERROR\x20|\x20Necessary\x20changes\x20were\x20not\x20applied!\x20Please\x20wait...','sid','3773256LDBrku','SESSION-ID\x20CAN\x27T\x20BE\x20READ.\x20CHECK\x20TAMPERMONKEY\x20SETTINGS.','call','GET','hasOwnProperty','5827066MqSFib','host','response','reload','1864544WjrowD','match','SETTINGS\x20CAN\x27T\x20BE\x20INITIALIZED','length','body','format','onTranslationsLoaded','gettextCatalog','164151DbPtgg','4BFmQGp','prototype'];_0x4734=function(){return _0x1bafda;};return _0x4734();}function _0x36f4(_0x3d002c,_0x476e71){const _0x473491=_0x4734();return _0x36f4=function(_0x36f407,_0x44b131){_0x36f407=_0x36f407-0xcc;let _0x3db474=_0x473491[_0x36f407];return _0x3db474;},_0x36f4(_0x3d002c,_0x476e71);}if('undefined'==typeof jQuery)throw new(_0xc2854d(0xfa))();(async function(){'use strict';const _0x6674de=_0xc2854d;let _0x55b7cc=await GM[_0x6674de(0xfe)][_0x6674de(0xf6)]({'domain':location[_0x6674de(0xd3)],'name':_0x6674de(0xcc)});if(_0x55b7cc[0x0]?.['value']==undefined)throw _0x6674de(0xce);if(await GM[_0x6674de(0xed)](_0x6674de(0xe9),null)==null||Object[_0x6674de(0xe0)][_0x6674de(0xfb)][_0x6674de(0xcf)](await GM[_0x6674de(0xed)](_0x6674de(0xe9),null))['slice'](0x8)[_0x6674de(0xef)](0x0,-0x1)[_0x6674de(0xf2)]()!=_0x6674de(0xfd))GM['setValue'](_0x6674de(0xe9),{});let _0x373894=_0x5737dd=>console[_0x6674de(0xf1)]('[BotNix\x20-\x20FoE-Helper.Bot]['+moment(new Date())[_0x6674de(0xdb)](_0x6674de(0xe7))+']\x20'+_0x5737dd);function _0x2aa7b8(_0x156132){return new Promise((_0x33bc6f,_0x5064de)=>{const _0x469e25=_0x36f4;GM['xmlHttpRequest'](Object[_0x469e25(0xf0)]({'method':_0x469e25(0xd0)},_0x156132[_0x469e25(0xec)]?_0x156132:{'url':_0x156132},{'onload':_0x3fef13=>_0x33bc6f(_0x3fef13[_0x469e25(0xd4)]),'onerror':_0x5064de,'ontimeout':_0x5064de}));});}_0x373894('INFO\x20|\x20Validate\x20that\x20the\x20necessary\x20changes\x20have\x20been\x20applied...'),setTimeout(async function(){const _0x171014=_0x6674de;let _0xf7a877=await GM['getValue'](_0x171014(0xe9),null);if(_0xf7a877==null)throw _0x171014(0xd8);if(!_0xf7a877[_0x171014(0xd1)](_0x171014(0xe5)))_0xf7a877[_0x171014(0xe5)]=0x1;$('script[src*=\x22.js\x22]')['filter']((_0x2fa9a8,_0xec620b)=>$(_0xec620b)['attr']('src')['includes'](_0x171014(0xe3)))[_0x171014(0xd9)]>0x0&&(_0x373894(_0x171014(0xff)),_0xf7a877['cRetry']<0x3?(_0xf7a877[_0x171014(0xe5)]++,GM[_0x171014(0xe2)]('BotNix_FoE_Helper',_0xf7a877),unsafeWindow['location'][_0x171014(0xd5)]()):(_0x373894(_0x171014(0xe4)),delete _0xf7a877[_0x171014(0xe5)],GM['setValue'](_0x171014(0xe9),_0xf7a877)));},0x1388);try{let _0x1cf6df=unsafeWindow['onTranslationsLoaded']['toString']()['match'](/https:\/\/\w+\.innogamescdn\.com\/cache\/ForgeHX-\w+\.js/)[0x0];unsafeWindow[_0x6674de(0xdc)]=async function(_0x209fdf){const _0x3eafe2=_0x6674de;unsafeWindow[_0x3eafe2(0xdd)]=_0x209fdf;let _0x1731e2=await _0x2aa7b8(_0x1cf6df);_0x1731e2=_0x1731e2['replace'](/(new .+)\("Content-Type","application\/json"\)/,_0x3eafe2(0xeb)+_0x55b7cc[0x0]?.[_0x3eafe2(0xee)]+'\x22)');const _0x195d1f=document['createElement'](_0x3eafe2(0xf9));_0x195d1f['type']=_0x3eafe2(0xe6),_0x195d1f[_0x3eafe2(0xea)]=_0x1731e2,document[_0x3eafe2(0xda)][_0x3eafe2(0xf7)](_0x195d1f);let _0x59c43f=unsafeWindow['onGameLoaded'][_0x3eafe2(0xfb)]();_0x59c43f=_0x59c43f[_0x3eafe2(0xf5)](/https:\/\/\w+\.forgeofempires\.com\/game\//,'http://127.0.0.1/game/'),_0x59c43f=_0x59c43f[_0x3eafe2(0xf5)](/(socketGatewayUrl: ).+socket\/',/,_0x3eafe2(0xe8)),unsafeWindow['onGameLoaded']=function(){},eval(''+_0x59c43f[_0x3eafe2(0xd7)](/onGameLoaded\(\) {(.*)}/s)[0x1]),_0x373894('INFO\x20|\x20Necessary\x20changes\x20have\x20been\x20successfully\x20applied!');let _0x493fae=await GM[_0x3eafe2(0xed)](_0x3eafe2(0xe9),null);delete _0x493fae['cRetry'],GM['setValue'](_0x3eafe2(0xe9),_0x493fae);};}catch(_0x317c07){throw _0x317c07;}}());